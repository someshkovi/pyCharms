from pysnmp import hlapi
from pysnmp.hlapi.asyncore import UdpTransportTarget
import csv
import pandas as pd
import sys

funcpath = r'C:\Users\somesh\Desktop\logs\Collection\functions'
sys.path.append(funcpath)

from snmpFunc import *

communitystring = 'publicCmtyStr'

#all required Oids
driveOids = ['1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.0.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.0.1.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.1.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.1.1.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.2.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.2.1.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.3.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.3.1.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.4.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.5.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.6.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.7.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.8.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.9.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.10.0.0',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.11.0.0',
            ]

rasOids = ['1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.1',
           '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.2',
           '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.3',
           '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.4',
           '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.5',
           '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.6',
          ]

statusOids = ['1.3.6.1.4.1.3764.1.1.200.20.80.10.1.14.8.0.0.0.0.0.1.0.59',
             '1.3.6.1.4.1.3764.1.1.200.20.80.10.1.6.8.0.0.0.0.0.1.0.59'
            ]

totalOids = statusOids+rasOids+driveOids

libStatus = {'1.3.6.1.4.1.3764.1.1.200.20.80.10.1.14.8.0.0.0.0.0.1.0.59':'library status',
             '1.3.6.1.4.1.3764.1.1.200.20.80.10.1.6.8.0.0.0.0.0.1.0.59':'robotic readiness'}

rasCompName = {'1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.1' : 'connectivity',
              '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.2' : 'control',
              '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.3' : 'media',
              '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.4' : 'drives',
              '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.5' : 'powerAndCooling',
              '1.3.6.1.4.1.3764.1.1.200.20.100.10.1.2.8.0.0.0.0.0.1.0.59.6' : 'robotics',
             }
driveName = {'1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.0.0.0': 'drive1',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.0.1.0': 'drive2',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.1.0.0': 'drive3',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.1.1.0': 'drive4',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.2.0.0': 'drive5',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.2.1.0': 'drive6',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.3.0.0': 'drive7',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.3.1.0': 'drive8',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.4.0.0': 'drive9',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.5.0.0': 'drive10',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.6.0.0': 'drive11',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.7.0.0': 'drive12',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.8.0.0': 'drive13',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.9.0.0': 'drive14',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.10.0.0': 'drive15',
             '1.3.6.1.4.1.3764.1.1.200.20.80.110.1.31.8.0.0.0.0.0.1.0.59.4.8.0.2.0.11.0.0': 'drive16',
            }

dictT = {**libStatus, **rasCompName, **driveName}

dictTF = pd.DataFrame(dictT.items(), columns = ['oid','name'])

statusDict = {1 : 'good',
              2 : 'failed',
              3 : 'degraded',
              4 : 'warning',
              5 : 'information',
              6 : 'unknown',
              7 : 'invalid'
             }
stausFrame = pd.DataFrame(statusDict.items(),columns = ['value','status'])

y = get('10.66.10.153', totalOids, hlapi.CommunityData(communitystring))

Summary = pd.DataFrame(y.items(), columns = ['oid','value'])

Summary = Summary.merge(dictTF, how = 'left', on='oid')
Summary = Summary.merge(stausFrame, how = 'left', on='value')

print(Summary)
